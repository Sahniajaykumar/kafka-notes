
Apache Kafka
___________

-> It acts as mediator to exchange messages (Message Broker)
-> Kafka is very useful for real time data exchange
-> Publisher will publish the message and subscriber will consume the message

Example of Kafka:

Scenario: 10 Customers Place Orders at Udupi Hotel
Step 1: Customers Place Orders
âœ… Customer App (Producer) â†’ Publishes each order to Kafka (order_topic).
âœ… Udupi Hotel (Consumer) â†’ Subscribes to order_topic and consumes the orders in real-time.

ğŸ”„ Kafka Flow:

10 Customers ---> [Kafka: order_topic] ---> Udupi Hotel App

Step 2: Udupi Hotel Accepts the Orders
âœ… Udupi Hotel (Producer) â†’ Publishes an "Order Accepted" event to order_status_topic.
âœ… Customer App (Consumer) â†’ Subscribes to order_status_topic and receives notifications.

ğŸ”„ Kafka Flow:

Udupi Hotel ---> [Kafka: order_status_topic] ---> 10 Customers
ğŸ”¹ Summary of the Pub/Sub Model
Step	Producer	Kafka Topic	Consumer	Purpose
Customer places order	Customer App	order_topic	Udupi Hotel App	Order received at restaurant
Udupi Hotel accepts order	Udupi Hotel App	order_status_topic	Customer App	Order confirmation notification

ğŸ”¹ When to Store in Database?
âœ”ï¸ YES â€“ When the customer places an order â†’ Store in DB (orders table).
âœ”ï¸ YES â€“ When the order is completed â†’ Update order status in DB.
âŒ NO â€“ For real-time updates (use Kafka instead).


Kafka Architecture:

1. Zookeeper  - This provides environment to run kafka server
2. Kafka Server  - This acts as message broker
3. Kafka Topic - It is used to store and queue messages
4. Publisher - This will push messages to kafkatopic
5. Subscriber - This will fetch the message that is pushed to kafka by publisher


Steps to setup kafka in windows:


Step-1 : Download Zookeeper:

   URL : https://dlcdn.apache.org/zookeeper/zookeeper-3.9.2/apache-zookeeper-3.9.2-bin.tar.gz
   URL : https://dlcdn.apache.org/zookeeper/zookeeper-3.8.4/apache-zookeeper-3.8.4-bin.tar.gz

Step-2 : Download Apache Kafka:

	URL : https://downloads.apache.org/kafka/3.8.0/kafka_2.12-3.8.0.tgz

Step-3 : Set Path of ZOOKEEPER in Environment variables upto bin folder.

Step 4: Copy "zookeeper.properties" and "server.properties" files from "kafka/config" folder to "kafka/bin/windows" folder.

Step-5 : Start Zookeeper server from "kafka/bin/windows" root folder

    Command : zookeeper-server-start.bat zookeeper.properties

Step-6: Start Kafka Server using below command from "kafka/bin/windows" folder

    Command : kafka-server-start.bat server.properties

Note: If kafka server is stopped, delete kafka logs from temp folder and try again to start kafka server

Step-7 : Create Kakfa Topic from "kafka/bin/windows" root folder

Command : kafka-topics.bat --create --bootstrap-server localhost:9092 --replication-factor 1 --partitions 1 --topic order_topic_1

Step-8 : View created Topics using below command

   Command : kafka-topics.bat --list --bootstrap-server localhost:9092


Kafka Bootstrap Server URL : http://localhost:9092/ or http://192.30.43.2:9092/ for linux server created in cloud



Q: Why should we use kafka ?

âœ… 1. Decoupling Microservices (Loose Coupling)

Without Kafka:

Service A sends data directly to Service B

If B is down â†’ A fails

System becomes fragile

With Kafka:

A sends message to Kafka

B reads it whenever itâ€™s available

Even if B is down, messages are safe

ğŸ‘‰ Microservices no longer depend on each other.

âœ… 2. High Performance (Real-Time Messaging)

Kafka handles millions of messages per second.

Perfect for:

Logs

Notifications

Payment events

Order processing

Tracking user activity

âœ… 3. Fault Tolerance (No Data Loss)

Kafka stores messages on disk and replicates them.
Even if a server crashes â†’ data is not lost.

âœ… 4. Scalability

Need more capacity?

Just add more Kafka brokers (servers).
Kafka scales horizontally and automatically.

âœ… 5. Asynchronous Communication

Services donâ€™t have to wait for each other.

Example:
User registers â†’ Auth service publishes message â†’
Email service reads it later â†’ SMS service reads it later.

Faster response time for the user.

âœ… 6. Multiple Consumers for Same Data

One message â†’ Many services can read it.

Example:
Order Created Event

Billing Service reads

Notification Service reads

Inventory Service reads

Analytics Service reads

Kafka supports fan-out messaging.
